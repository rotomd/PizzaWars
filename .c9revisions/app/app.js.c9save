{"ts":1355671263864,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/**\n * This is the main (and only) node instance for running PizzaWars\n *\tTo Do:\n *\t\tAPI:\n *\t\t\tImplement calculating the shops score\n *\t\t\tImplement getting a list of people\n *\t\t\tImplement getting a person and their shop order\n *\t\t\tImplement log in\n *\t\tPages:\n *\t\t\tImplement home page\n *\t\t\tImplement shops page\n *\t\t\tImplement persons page\n *\t\t\tImplement persons page editable\n */\n\n/* Express quick setup */\nvar express = require('express');\nvar app = express();\n\n/* mongodb setup */\nvar mongo = require('mongodb');\n\nvar host = process.env['DOTCLOUD_DB_MONGODB_HOST'] || 'localhost';\nvar port = process.env['DOTCLOUD_DB_MONGODB_PORT'] ||  27017;\nport = parseInt(port);\nvar user = process.env['DOTCLOUD_DB_MONGODB_LOGIN'] || undefined;\nvar pass = process.env['DOTCLOUD_DB_MONGODB_PASSWORD'] || undefined;\n\nvar mongoServer = new mongo.Server(host, port, {});\nvar db = new mongo.Db(\"admin\", mongoServer, {auto_reconnect:true});\n\n/**\n * All API requests will go in this section\n * \tList of possible API calls:\n *\t\t/shops/\n *\t\t/shop/{name}/\n *\t\t/people/\n *\t\t/person/{name}/\n **/\n\n/**\n * API request to get all shops in the database\n **/\napp.get(\"/shops/\", function(request, response){\n\tresponse.contentType = \"application/json\";\n\tdb.collection(\"shops\", function(err, collection){\n\t\tif (!err)\n\t\t{\n\t\t\tcollection.find().toArray(function(err, results){\n\t\t\t\tif (!err)\n\t\t\t\t{\n\t\t\t\t\tresponse.write(JSON.stringify(results));\n\t\t\t\t\tresponse.end();\n\t\t\t\t}else\n\t\t\t\t{\n\t\t\t\t\tresponse.write(JSON.stringify({error: err}));\n\t\t\t\t\tresponse.end();\n\t\t\t\t}\n\t\t\t});\n\t\t}else\n\t\t{\n\t\t\tresponse.write(JSON.stringify({error: err}));\n\t\t\tresponse.end();\n\t\t}\n\t});\n});\n/**\n * All page handles will occur here.\n *\tPossible Pages:\n *\t\thtml.html\n *\t\tperson.html\n *\t\tshop.html\n **/\napp.get(\"/\", function(req, res){\n    var fs = require(\"fs\");\n    fs.readFile(\"home.html\", function(err,data)\n    {\n    \tif (err)\n    \t{\n    \t\tres.write(err);\n    \t\tres.end();\n    \t}else\n    \t{\n    \t\tres.write(data);\n    \t\tres.end();\n    \t}\n    });\n});\nvar authError = \"NO ERROR\";\ndb.open(function(err){\n    if(err) \n    {\n    \tconsole.log(err);\n    \tauthError = \"1.\" + err;\n    }\n\n    if(user && pass) \n    {\n        db.authenticate(user, pass, function(err) {\n        \tif (err)\n        \t{\n        \t\tauthError = \"2.\" + err;\n        \t}\n            app.listen(8080);\n        });\n    }\n    else {\n        app.listen(8080);\n    }\n});"]],"start1":0,"start2":0,"length1":0,"length2":2361}]],"length":2361}
{"contributors":[],"silentsave":false,"ts":1355671288526,"patch":[[{"diffs":[[0,"table\n *"],[-1,"/"],[1," \n */\n \n // test comment to see if I can synch with cloud 9 and git hub and local."],[0,"\n\n/* Exp"]],"start1":369,"start2":369,"length1":17,"length2":98}]],"length":2442,"saved":false}
{"ts":1355671511219,"patch":[[{"diffs":[[0,"d local."],[1,"\n //foo bar"],[0,"\n\n/* Exp"]],"start1":451,"start2":451,"length1":16,"length2":27}]],"length":2453,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355673575448,"patch":[[{"diffs":[[0,"o bar\n\n/"],[-1,""],[0,""],[1,"/ test\n\n/"],[0,"* Expres"]],"start1":465,"start2":465,"length1":16,"length2":25},{"diffs":[[0,"e}/\n **/"],[1,"\n \n function writeError(response, error)\n {\n     response.write(JSON.stringify({error: error}));\n     response.end();\n }"],[0,"\n\n/**\n *"]],"start1":1164,"start2":1164,"length1":16,"length2":136},{"diffs":[[0,"\t\t\t\t"],[-1,"response.write(JSON.stringify({error:"],[1,"writeError(response, err);\n\t\t\t\t}\n\t\t\t});\n\t\t}else\n\t\t{\n\t\t\twriteError(response,"],[0," err"],[-1,"})"],[0,");\n\t\t"],[-1,"\t\t\tresponse.end();\n\t\t\t\t}\n\t\t\t});\n\t\t}else\n\t\t{\n\t\t\tresponse.write(JSON.stringify({error: err}));\n\t\t\tresponse.end();\n\t\t}\n\t"],[1,"}\n\t});\n});\napp.get(\"/people/\", function(request, response){\n    response.contentType = \"application/json\";\n    db.collection(\"people\", function(err, collection){\n       if (!err)\n       {\n           collection.find().toArray(function(err, results){\n               if (!err)\n               {\n                   response.write(JSON.stringify(results));\n                   response.end();\n               }else\n               {\n                   writeError(response, err);\n               }\n           });\n       }else\n       {\n           writeError(response, err);\n       }\n    "],[0,"});\n})"],[-1,";"],[0,"\n/**"]],"start1":1667,"start2":1667,"length1":180,"length2":673}]],"length":3075,"saved":false}
{"ts":1355673707320,"patch":[[{"diffs":[[0,"err)\n    \t{\n    "],[-1,"\t\t"],[1,"        "],[0,"res.write(err);\n"]],"start1":2570,"start2":2570,"length1":34,"length2":40},{"diffs":[[0,"e(err);\n    "],[1,"  "],[-1,"\t\t"],[1,"      "],[0,"res.end();\n "]],"start1":2602,"start2":2602,"length1":26,"length2":32},{"diffs":[[0,"\n    \t{\n    "],[1,"   "],[-1,"\t\t"],[1,"     "],[0,"res.write(da"]],"start1":2643,"start2":2643,"length1":26,"length2":32},{"diffs":[[0,"a);\n    "],[-1,"\t\t"],[1,"        "],[0,"res.end("]],"start1":2676,"start2":2676,"length1":18,"length2":24},{"diffs":[[0,".end();\n    "],[-1,"\t"],[1,"    "],[0,"}\n    });\n})"]],"start1":2695,"start2":2695,"length1":25,"length2":28},{"diffs":[[0,"  {\n    "],[-1,"\t"],[1,"    "],[0,"console."]],"start1":2791,"start2":2791,"length1":17,"length2":20},{"diffs":[[0,"r);\n    "],[-1,"\t"],[1,"    "],[0,"authErro"]],"start1":2817,"start2":2817,"length1":17,"length2":20},{"diffs":[[0,") {\n        "],[-1,"\t"],[1,"    "],[0,"if (err)\n   "]],"start1":2936,"start2":2936,"length1":25,"length2":28},{"diffs":[[0,"    "],[-1,"\t{\n"],[1,"    {\n   "],[0,"        "],[-1,"\t\t"],[1,"     "],[0,"auth"]],"start1":2965,"start2":2965,"length1":21,"length2":30},{"diffs":[[0,"        "],[-1,"\t"],[1,"    "],[0,"}\n      "]],"start1":3015,"start2":3015,"length1":17,"length2":20}]],"length":3123,"saved":false}
{"ts":1355674083138,"patch":[[{"diffs":[[0,"xpress')"],[-1,";\nvar"],[1,",\n   "],[0," app = e"]],"start1":531,"start2":531,"length1":21,"length2":21},{"diffs":[[0,"xpress()"],[1,",\n    server = require(\"http\").createServer(app),\n    io = require(\"socket.io\").listen(server)"],[0,";\n\n/* mo"]],"start1":552,"start2":552,"length1":16,"length2":110}]],"length":3217,"saved":false}
{"ts":1355674237430,"patch":[[{"diffs":[[0,"\n **/\n \n"],[1," io.sockets.on(\"connection\", function(socket){\n     socket.emit(\"news\", { hello: \"world\" });\n });\n \n"],[0," functio"]],"start1":1261,"start2":1261,"length1":16,"length2":116}]],"length":3317,"saved":false}
{"ts":1355674278333,"patch":[[{"diffs":[[0,"(req, res){\n"],[1,"    res.sendfile(\"home.html\");\n    /*\n"],[0,"    var fs ="]],"start1":2661,"start2":2661,"length1":24,"length2":62},{"diffs":[[0,"  }\n    });\n"],[1,"    */\n"],[0,"});\nvar auth"]],"start1":2941,"start2":2941,"length1":24,"length2":31}]],"length":3362,"saved":false}
{"ts":1355687446077,"patch":[[{"diffs":[[0,"ver(app)"],[-1,","],[1,";"],[0,"\n    "],[1,"//"],[0,"io = req"]],"start1":600,"start2":600,"length1":22,"length2":24},{"diffs":[[0,"\n **/\n \n"],[1," /*\n"],[0," io.sock"]],"start1":1263,"start2":1263,"length1":16,"length2":20},{"diffs":[[0,");\n });\n"],[1," */\n"],[0," \n funct"]],"start1":1365,"start2":1365,"length1":16,"length2":20}]],"length":3372,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356216410935,"patch":[[{"diffs":[[0,"nd();\n }"],[1,"\n \n /**\n  * Simple test to see if dotcloud push is working from my location\n  */\napp.get(\"/session/\", function(request, response){\n    if (request.session)\n    {\n        response.write(\"I have a session\");\n        if (request.session.user_id)\n        {\n            response.write(\"I have a user_id\");\n        }\n    }\n});"],[0,"\n\n/**\n *"]],"start1":1488,"start2":1488,"length1":16,"length2":336}]],"length":3692,"saved":false}
{"ts":1356216457504,"patch":[[{"diffs":[[0," user_id\");\n"],[1,"        }else{\n            request.session.user_id = \"roto\";\n"],[0,"        }\n  "]],"start1":1785,"start2":1785,"length1":24,"length2":85}]],"length":3753,"saved":false}
{"ts":1356216572809,"patch":[[{"diffs":[[0,"}\n    }\n"],[1,"    response.end();\n"],[0,"});\n\n/**"]],"start1":1866,"start2":1866,"length1":16,"length2":36}]],"length":3773,"saved":false}
{"ts":1356216651472,"patch":[[{"diffs":[[0,";\n        }\n"],[1,"    }else{\n        response.write(\"Session does not exist\");\n"],[0,"    }\n    re"]],"start1":1856,"start2":1856,"length1":24,"length2":85}]],"length":3834,"saved":false}
{"ts":1356217477969,"patch":[[{"diffs":[[0,"ress'),\n"],[1,"    connect = require('connect'),\n"],[0,"    app "]],"start1":533,"start2":533,"length1":16,"length2":50}]],"length":3868,"saved":false}
{"ts":1356217516213,"patch":[[{"diffs":[[0," response){\n"],[1,"    if (connect){\n        response.write(\"connect installed\");\n    }\n"],[0,"    if (requ"]],"start1":1649,"start2":1649,"length1":24,"length2":93}]],"length":3937,"saved":false}
{"ts":1356217679343,"patch":[[{"diffs":[[0,"'),\n    "],[1,"//"],[0,"connect "]],"start1":537,"start2":537,"length1":16,"length2":18},{"diffs":[[0," response){\n"],[1,"    var connect;\n    try{\n        connect = require(\"connect\");\n    }catch(err){\n        response.write(\"errr\");\n        response.write(err);\n    }\n"],[0,"    if (conn"]],"start1":1651,"start2":1651,"length1":24,"length2":172}]],"length":4087,"saved":false}
{"ts":1356217871665,"patch":[[{"diffs":[[0,"ble\n * \n"],[1," * Notes:\n *      NPM must be installed in the pizzawars folder\n *      not the app folder. \n"],[0," */\n \n /"]],"start1":371,"start2":371,"length1":16,"length2":109},{"diffs":[[0,"'),\n    "],[-1,"//"],[0,"connect "]],"start1":630,"start2":630,"length1":18,"length2":16}]],"length":4178,"saved":false}
{"ts":1356217887425,"patch":[[{"diffs":[[0,"e){\n"],[-1,"    var connect;\n    try{\n        connect = require(\"connect\");\n    }catch(err){\n        response.write(\"errr\");\n        response.write(err);\n    }\n"],[0,"    "]],"start1":1750,"start2":1750,"length1":156,"length2":8}]],"length":4030,"saved":false}
{"ts":1356218041264,"patch":[[{"diffs":[[0,";\n */\n \n"],[1," app.configure(function(){\n    app.use(connect.session({secret: \"top-secret\"})); \n });\n \n"],[0," functio"]],"start1":1498,"start2":1498,"length1":16,"length2":105}]],"length":4119,"saved":false}
{"ts":1356226624586,"patch":[[{"diffs":[[0,"tion(){\n    "],[1,"//"],[0,"app.use(conn"]],"start1":1525,"start2":1525,"length1":24,"length2":26},{"diffs":[[0,"t\"})); \n"],[1,"    app.use(express.session({secret: \"top-secret\"}));\n"],[0," });\n \n "]],"start1":1582,"start2":1582,"length1":16,"length2":70}]],"length":4175,"saved":false}
{"ts":1356226712538,"patch":[[{"diffs":[[0,"t\"})); \n    "],[1,"//"],[0,"app.use(expr"]],"start1":1582,"start2":1582,"length1":24,"length2":26}]],"length":4177,"saved":false}
{"ts":1356226856103,"patch":[[{"diffs":[[0,".write(\""],[-1,"S"],[1,"request.s"],[0,"ession d"]],"start1":2238,"start2":2238,"length1":17,"length2":25},{"diffs":[[0,"ot exist\");\n"],[1,"        if (response.session)\n        {\n            response.write(\"response.session exists\");\n        }\n"],[0,"    }\n    re"]],"start1":2268,"start2":2268,"length1":24,"length2":129}]],"length":4290,"saved":false}
{"ts":1356227512904,"patch":[[{"diffs":[[0,"et\"}));\n"],[1,"    app.use(express.bodyParser());\n    app.use(express.cookieParser());\n    app.use(express.session({secret: 'my secret'}));\n"],[0," });\n \n "]],"start1":1638,"start2":1638,"length1":16,"length2":141},{"diffs":[[0,");\n    }\n});"],[1,"\n"]],"start1":4403,"start2":4403,"length1":12,"length2":13}]],"length":4416,"saved":false}
{"ts":1356227800059,"patch":[[{"diffs":[[0,"\tTo Do:\n"],[1," *      Authentication:\n *          When someone logs in, request.session.user_id\n *          will hold some credential that will be saved in\n *          mongo (IE guid to links to an account).\n"],[0," *\t\tAPI:"]],"start1":73,"start2":73,"length1":16,"length2":210},{"diffs":[[0," user_id"],[-1,"\""],[1,": \" + request.session.user_id"],[0,");\n     "]],"start1":2447,"start2":2447,"length1":17,"length2":45}]],"length":4638,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356277466715,"patch":[[{"diffs":[[0,"'connect'),\n"],[1,"    path = require('path'),\n"],[0,"    app = ex"]],"start1":850,"start2":850,"length1":24,"length2":52},{"diffs":[[0,"et'}));\n"],[1,"    return app.use(express[\"static\"](path.join(__dirname, 'public')));\n"],[0," });\n \n "]],"start1":1985,"start2":1985,"length1":16,"length2":87}]],"length":4737,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356280547548,"patch":[[{"diffs":[[0,"secret'}));\n"],[1,"    app.use(express.static(__dirname + \"/public\"));\n"],[0,"    return a"]],"start1":1981,"start2":1981,"length1":24,"length2":76}]],"length":4789,"saved":false}
{"ts":1356280551862,"patch":[[{"diffs":[[0,"));\n    "],[1,"//"],[0,"return a"]],"start1":2041,"start2":2041,"length1":16,"length2":18}]],"length":4791,"saved":false}
{"ts":1356280793381,"patch":[[{"diffs":[[0,"(){\n"],[-1,"    //app.use(connect.session({secret: \"top-secret\"})); \n    //app.use(express.session({secret: \"top-secret\"}));\n"],[0,"    "]],"start1":1751,"start2":1751,"length1":121,"length2":8},{"diffs":[[0,"));\n"],[-1,"    //return app.use(express[\"static\"](path.join(__dirname, 'public')));\n"],[0," });"]],"start1":1928,"start2":1928,"length1":81,"length2":8}]],"length":4605,"saved":false}
{"ts":1356280859943,"patch":[[{"diffs":[[0,";\n})"],[-1,"\n/**\n * All page handles will occur here.\n *\tPossible Pages:\n *\t\thtml.html\n *\t\tperson.html\n *\t\tshop.html\n **/\napp.get(\"/\", function(req, res){\n    res.sendfile(\"home.html\");\n    /*\n    var fs = require(\"fs\");\n    fs.readFile(\"home.html\", function(err,data)\n    {\n    \tif (err)\n    \t{\n            res.write(err);\n            res.end();\n    \t}else\n    \t{\n            res.write(data);\n            res.end();\n        }\n    });\n    */\n});\nvar authError = \"NO ERROR\""],[0,";"],[1,"\n"],[0,"\ndb."]],"start1":3768,"start2":3768,"length1":469,"length2":10}]],"length":4146,"saved":false}
{"ts":1356280865728,"patch":[[{"diffs":[[0,");\n});\n\n"],[1,"var authError = \"NO ERROR\";\n"],[0,"db.open("]],"start1":3767,"start2":3767,"length1":16,"length2":44}]],"length":4174,"saved":false}
{"ts":1356281132345,"patch":[[{"diffs":[[0,"     NPM"],[1,"s"],[0," must be"]],"start1":586,"start2":586,"length1":16,"length2":17},{"diffs":[[0,"\n */"],[-1,"\n \n // test comment to see if I can synch with cloud 9 and git hub and local.\n //foo bar\n\n// test"],[0,"\n\n/*"]],"start1":666,"start2":666,"length1":105,"length2":8}]],"length":4078,"saved":false}
{"ts":1356368691809,"patch":[[{"diffs":[[0,"older. \n"],[1," * \n * Mongo DB:\n *  > dotcloud run db mongo\n *  > use admin\n *  > db.auth(\"root\", \"[root-pw]\");\n *  > show dbs\n *  > use admin\n *  > db.people.find()\n *  > db.shops.find()\n"],[0," */\n\n/* "]],"start1":659,"start2":659,"length1":16,"length2":189}]],"length":4251,"saved":false}
{"ts":1356370055625,"patch":[[{"diffs":[[0,"end();\n});\n\n"],[1,"app.post(\"/login/\", function(request, response){\n    var username = request[\"username\"],\n        password = request[\"password\"];\n    response.contentType = \"application/json\";\n    db.collection(\"logins\", function(err, collection){\n        if (!err)\n        {\n            collection\n                .find({username: username, password: password})\n                .toArray(function(err, results){\n                    if (!err)\n                    {\n                        if (results.length === 1)\n                        {\n                        }else\n                        {\n                            writeError(response, \"Invalid username or password\");\n                        }\n                    }else\n                    {\n                        writeError(response, \"Could not query object\");\n                    }\n            });\n        }else\n        {\n            writeError(response, \"Could not connect to database\");\n        }\n    });\n});\n\n"],[0,"/**\n * API r"]],"start1":2795,"start2":2795,"length1":24,"length2":983}]],"length":5210,"saved":false}
{"ts":1356370194727,"patch":[[{"diffs":[[0,"e){\n    var "],[1,"result, responseObj,\n        "],[0,"username = r"]],"start1":2852,"start2":2852,"length1":24,"length2":53},{"diffs":[[0,"              {\n"],[1,"                           result = results[0];\n                           request.session.user_id = result.key;\n                           responseObj = { authorized: true };\n                           response.send(JSON.stringify(responseObj));\n"],[0,"                "]],"start1":3343,"start2":3343,"length1":32,"length2":279}]],"length":5486,"saved":false}
{"ts":1356370529664,"patch":[[{"diffs":[[0,"    "],[-1,"writeError(response, \"Invalid username or password\""],[1,"responseObj = { username: username, password: password, authorized: false, results: results };\n                            response.send(JSON.stringify(responseObj)"],[0,");\n "]],"start1":3686,"start2":3686,"length1":59,"length2":172}]],"length":5599,"saved":false}
{"ts":1356371018261,"patch":[[{"diffs":[[0," request"],[-1,"["],[1,".param("],[0,"\"usernam"]],"start1":2903,"start2":2903,"length1":17,"length2":23},{"diffs":[[0,"sername\""],[-1,"]"],[1,", \"\")"],[0,",\n      "]],"start1":2920,"start2":2920,"length1":17,"length2":21},{"diffs":[[0," request"],[-1,"["],[1,".param("],[0,"\"passwor"]],"start1":2953,"start2":2953,"length1":17,"length2":23},{"diffs":[[0,"assword\""],[-1,"]"],[1,", \"\")"],[0,";\n    re"]],"start1":2970,"start2":2970,"length1":17,"length2":21}]],"length":5619,"saved":false}
{"ts":1356371433799,"patch":[[{"diffs":[[0,"d()\n */\n"],[-1,"\n"],[1," \n(function(){\n    \"use strict\";\n\n    "],[0,"/* Expre"]],"start1":836,"start2":836,"length1":17,"length2":54},{"diffs":[[0,"ck setup */\n"],[1,"    "],[0,"var express "]],"start1":896,"start2":896,"length1":24,"length2":28},{"diffs":[[0,"'),\n    "],[1,"  "],[1,"  "],[0,"connect "]],"start1":942,"start2":942,"length1":16,"length2":20},{"diffs":[[0,"'),\n    "],[1,"   "],[1," "],[0,"path = r"]],"start1":980,"start2":980,"length1":16,"length2":20},{"diffs":[[0,"re('path'),\n"],[1,"    "],[0,"    app = ex"]],"start1":1004,"start2":1004,"length1":24,"length2":28},{"diffs":[[0,"ress(),\n"],[1,"    "],[0,"    serv"]],"start1":1033,"start2":1033,"length1":16,"length2":20},{"diffs":[[0,"r(app);\n"],[1,"    "],[0,"    //io"]],"start1":1085,"start2":1085,"length1":16,"length2":20},{"diffs":[[0,"erver);\n"],[-1,"\n"],[1,"    \n    "],[0,"/* mongo"]],"start1":1137,"start2":1137,"length1":17,"length2":25},{"diffs":[[0,"etup */\n"],[1,"    "],[0,"var mong"]],"start1":1166,"start2":1166,"length1":16,"length2":20},{"diffs":[[0,"godb');\n"],[-1,"\n"],[1,"    \n    "],[0,"var host"]],"start1":1202,"start2":1202,"length1":17,"length2":25},{"diffs":[[0,"lhost';\n"],[1,"    "],[0,"var port"]],"start1":1278,"start2":1278,"length1":16,"length2":20},{"diffs":[[0," 27017;\n"],[1,"    "],[0,"port = p"]],"start1":1344,"start2":1344,"length1":16,"length2":20},{"diffs":[[0,"(port);\n"],[1,"    "],[0,"var user"]],"start1":1371,"start2":1371,"length1":16,"length2":20},{"diffs":[[0,"efined;\n"],[1,"    "],[0,"var pass"]],"start1":1441,"start2":1441,"length1":16,"length2":20},{"diffs":[[0,"efined;\n"],[-1,"\n"],[1,"    \n    "],[0,"var mong"]],"start1":1514,"start2":1514,"length1":17,"length2":25},{"diffs":[[0,"t, {});\n"],[1,"    "],[0,"var db ="]],"start1":1575,"start2":1575,"length1":16,"length2":20},{"diffs":[[0,"ect:true});\n"],[-1,"\n/**\n"],[1,"    \n    /**\n    "],[0," * All API r"]],"start1":1643,"start2":1643,"length1":29,"length2":41},{"diffs":[[0,"section\n"],[1,"    "],[0," * \tList"]],"start1":1708,"start2":1708,"length1":16,"length2":20},{"diffs":[[0," calls:\n"],[1,"    "],[0," *\t\t/sho"]],"start1":1744,"start2":1744,"length1":16,"length2":20},{"diffs":[[0,"/shops/\n"],[1,"    "],[0," *\t\t/sho"]],"start1":1760,"start2":1760,"length1":16,"length2":20},{"diffs":[[0,"{name}/\n"],[1,"    "],[0," *\t\t/peo"]],"start1":1782,"start2":1782,"length1":16,"length2":20},{"diffs":[[0,"people/\n"],[1,"    "],[0," *\t\t/per"]],"start1":1799,"start2":1799,"length1":16,"length2":20},{"diffs":[[0,"}/\n "],[-1,"**/\n \n /*\n"],[1,"    **/\n     \n     /*\n    "],[0," io."]],"start1":1828,"start2":1828,"length1":18,"length2":34},{"diffs":[[0,"){\n     "],[1,"  "],[1,"  "],[0,"socket.e"]],"start1":1902,"start2":1902,"length1":16,"length2":20},{"diffs":[[0,"});\n"],[1,"    "],[0," });\n "],[-1,"*/\n \n"],[1,"    */\n     \n     function isAuthorized(request)\n     {\n         if (request.session.user_id)\n         {\n             return { authorized: true, key: request.session.user_id };\n         }\n         return { authorized: false, key: \"\" };\n     }\n     \n    "],[0," app"]],"start1":1951,"start2":1951,"length1":19,"length2":271},{"diffs":[[0,"function(){\n"],[1,"    "],[0,"    app.use("]],"start1":2233,"start2":2233,"length1":24,"length2":28},{"diffs":[[0,"yParser());\n    "],[1,"   "],[1," "],[0,"app.use(express."]],"start1":2272,"start2":2272,"length1":32,"length2":36},{"diffs":[[0,"eParser());\n"],[1,"    "],[0,"    app.use("]],"start1":2313,"start2":2313,"length1":24,"length2":28},{"diffs":[[0,"secret'}));\n"],[1,"    "],[0,"    app.use("]],"start1":2370,"start2":2370,"length1":24,"length2":28},{"diffs":[[0,"));\n"],[1,"    "],[0," });\n "],[-1,"\n"],[1,"    \n    "],[0," fun"]],"start1":2434,"start2":2434,"length1":15,"length2":27},{"diffs":[[0,"error)\n "],[-1,"{\n"],[1,"    {\n  "],[0,"     "],[1,"  "],[0,"response"]],"start1":2488,"start2":2488,"length1":23,"length2":31},{"diffs":[[0,"or}));\n     "],[1,"    "],[0,"response.end"]],"start1":2552,"start2":2552,"length1":24,"length2":28},{"diffs":[[0,");\n "],[-1,"}\n \n /**\n"],[1,"    }\n     \n     /**\n    "],[0,"  * "]],"start1":2581,"start2":2581,"length1":17,"length2":33},{"diffs":[[0,"ation\n  "],[-1,"*/\n"],[1,"    */\n    "],[0,"app.get("]],"start1":2672,"start2":2672,"length1":19,"length2":27},{"diffs":[[0," response){\n"],[1,"    "],[0,"    if (conn"]],"start1":2729,"start2":2729,"length1":24,"length2":28},{"diffs":[[0," (connect){\n"],[1,"    "],[0,"        resp"]],"start1":2751,"start2":2751,"length1":24,"length2":28},{"diffs":[[0,"lled\");\n    "],[-1,"}\n"],[1,"    }\n    "],[0,"    if (requ"]],"start1":2804,"start2":2804,"length1":26,"length2":34},{"diffs":[[0,"ession)\n    "],[1,"  "],[-1,"{\n"],[1,"  {\n    "],[0,"        resp"]],"start1":2843,"start2":2843,"length1":26,"length2":34},{"diffs":[[0,"sion\");\n        "],[1,"   "],[1," "],[0,"if (request.sess"]],"start1":2901,"start2":2901,"length1":32,"length2":36},{"diffs":[[0,"ser_id)\n        "],[-1,"{\n"],[1,"    {\n    "],[0,"            resp"]],"start1":2942,"start2":2942,"length1":34,"length2":42},{"diffs":[[0,"d);\n        "],[1,"    "],[0,"}else{\n"],[1,"    "],[0,"            "]],"start1":3040,"start2":3040,"length1":31,"length2":39},{"diffs":[[0,"    "],[1," "],[-1,"}\n"],[1,"   }\n   "],[0,"    "],[1," "],[0,"}else{\n"],[1,"    "],[0,"    "]],"start1":3117,"start2":3117,"length1":21,"length2":33},{"diffs":[[0,"\");\n        "],[1,"    "],[0,"if (response"]],"start1":3200,"start2":3200,"length1":24,"length2":28},{"diffs":[[0,"sponse.session)\n"],[1,"    "],[0,"        {\n      "]],"start1":3222,"start2":3222,"length1":32,"length2":36},{"diffs":[[0,"  {\n            "],[1,"    "],[0,"response.write(\""]],"start1":3248,"start2":3248,"length1":32,"length2":36},{"diffs":[[0,"    "],[-1,"}\n"],[1,"    }\n   "],[0,"    "],[1," "],[0,"}\n"],[1,"    "],[0,"    "]],"start1":3315,"start2":3315,"length1":16,"length2":28},{"diffs":[[0,".end();\n"],[-1,"});\n\n"],[1,"    });\n    \n    app.get(\"/auth/\", function(request, response){\n        var responseObj;\n        response.contentType = \"application/json\";\n        \n        if (request.session.user_id)\n        {\n        }\n    });\n    \n    "],[0,"app.post"]],"start1":3351,"start2":3351,"length1":21,"length2":239},{"diffs":[[0," response){\n"],[1,"    "],[0,"    var resu"]],"start1":3619,"start2":3619,"length1":24,"length2":28},{"diffs":[[0,"nseObj,\n"],[1,"    "],[0,"        "]],"start1":3656,"start2":3656,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"    "],[0,"password"]],"start1":3718,"start2":3718,"length1":16,"length2":20},{"diffs":[[0,"\", \"\");\n    "],[1," "],[1,"   "],[0,"response.con"]],"start1":3764,"start2":3764,"length1":24,"length2":28},{"diffs":[[0,"tion/json\";\n    "],[1,"  "],[1,"  "],[0,"db.collection(\"l"]],"start1":3811,"start2":3811,"length1":32,"length2":36},{"diffs":[[0,"ction){\n        "],[1,"    "],[0,"if (!err)\n      "]],"start1":3874,"start2":3874,"length1":32,"length2":36},{"diffs":[[0," (!err)\n        "],[1,"   "],[1," "],[0,"{\n"],[1,"    "],[0,"            coll"]],"start1":3896,"start2":3896,"length1":34,"length2":42},{"diffs":[[0," collection\n"],[1,"    "],[0,"            "]],"start1":3933,"start2":3933,"length1":24,"length2":28},{"diffs":[[0,"        "],[1,"    "],[0,".toArray"]],"start1":4021,"start2":4021,"length1":16,"length2":20},{"diffs":[[0,"                "],[1,"    "],[0,"if (!err)\n      "]],"start1":4070,"start2":4070,"length1":32,"length2":36},{"diffs":[[0,"                "],[1," "],[-1,"{\n"],[1,"   {\n    "],[0,"                "]],"start1":4104,"start2":4104,"length1":34,"length2":42},{"diffs":[[0,"                "],[-1,"{\n"],[1,"    {\n    "],[0,"                "]],"start1":4188,"start2":4188,"length1":34,"length2":42},{"diffs":[[0,"lts[0];\n"],[1,"    "],[0,"        "]],"start1":4254,"start2":4254,"length1":16,"length2":20},{"diffs":[[0,"                "],[1,"    "],[0,"responseObj = { "]],"start1":4342,"start2":4342,"length1":32,"length2":36},{"diffs":[[0,"ed: true };\n"],[1,"    "],[0,"            "]],"start1":4386,"start2":4386,"length1":24,"length2":28},{"diffs":[[0,"                "],[1,"    "],[0,"}else\n          "]],"start1":4481,"start2":4481,"length1":32,"length2":36},{"diffs":[[0,"                "],[-1,"{\n"],[1,"    {\n  "],[0,"                "]],"start1":4515,"start2":4515,"length1":34,"length2":40},{"diffs":[[0,"                "],[1,"  "],[0,"responseObj = { "]],"start1":4551,"start2":4551,"length1":32,"length2":34},{"diffs":[[0,"                "],[1,"    "],[0,"response.send(JS"]],"start1":4676,"start2":4676,"length1":32,"length2":36},{"diffs":[[0,"(responseObj));\n"],[1,"    "],[0,"                "]],"start1":4724,"start2":4724,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"}else\n          "]],"start1":4774,"start2":4774,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"{\n              "]],"start1":4804,"start2":4804,"length1":32,"length2":36},{"diffs":[[0,"                "],[1," "],[1,"   "],[0,"writeError(respo"]],"start1":4834,"start2":4834,"length1":32,"length2":36},{"diffs":[[0,"                "],[-1,"}\n"],[1,"    }\n    "],[0,"            });\n"]],"start1":4906,"start2":4906,"length1":34,"length2":42},{"diffs":[[0,"    });\n        "],[1,"    "],[0,"}else\n        {\n"]],"start1":4940,"start2":4940,"length1":32,"length2":36},{"diffs":[[0,"  }else\n        "],[1,"   "],[1," "],[0,"{\n"],[1,"    "],[0,"            writ"]],"start1":4958,"start2":4958,"length1":34,"length2":42},{"diffs":[[0,"    "],[-1,"}\n"],[1,"    }\n   "],[0,"    "],[1," "],[0,"});\n"],[-1,"});\n\n/**\n"],[1,"    });\n    \n    /**\n    "],[0," * A"]],"start1":5055,"start2":5055,"length1":27,"length2":51},{"diffs":[[0,"tabase\n "],[-1,"**/\n"],[1,"    **/\n    "],[0,"app.get("]],"start1":5143,"start2":5143,"length1":20,"length2":28},{"diffs":[[0,"ponse){\n"],[1,"    "],[0,"\trespons"]],"start1":5203,"start2":5203,"length1":16,"length2":20},{"diffs":[[0,"/json\";\n"],[1,"    "],[0,"\tdb.coll"]],"start1":5251,"start2":5251,"length1":16,"length2":20},{"diffs":[[0,"ction){\n"],[1,"    "],[0,"\t\tif (!e"]],"start1":5306,"start2":5306,"length1":16,"length2":20},{"diffs":[[0," (!err)\n"],[-1,"\t\t{\n"],[1,"    \t\t{\n    "],[0,"\t\t\tcolle"]],"start1":5322,"start2":5322,"length1":20,"length2":28},{"diffs":[[0,"sults){\n"],[1,"    "],[0,"\t\t\t\tif ("]],"start1":5387,"start2":5387,"length1":16,"length2":20},{"diffs":[[0," (!err)\n"],[1,"    "],[0,"\t\t\t\t{\n"],[1,"    "],[0,"\t\t\t\t\tres"]],"start1":5405,"start2":5405,"length1":22,"length2":30},{"diffs":[[0,"ults));\n"],[1,"    "],[0,"\t\t\t\t\tres"]],"start1":5465,"start2":5465,"length1":16,"length2":20},{"diffs":[[0,".end();\n"],[1,"    "],[0,"\t\t\t\t}els"]],"start1":5490,"start2":5490,"length1":16,"length2":20},{"diffs":[[0,"\t\t}else\n"],[1,"    "],[0,"\t\t\t\t{\n"],[1,"    "],[0,"\t\t\t\t\twri"]],"start1":5504,"start2":5504,"length1":22,"length2":30},{"diffs":[[0,"r);\n"],[1,"    "],[0,"\t\t\t\t}\n"],[1,"    "],[0,"\t\t\t});\n"],[1,"    "],[0,"\t\t}else\n"],[-1,"\t\t{\n"],[1,"    \t\t{\n    "],[0,"\t\t\tw"]],"start1":5554,"start2":5554,"length1":33,"length2":53},{"diffs":[[0,"r);\n"],[-1,"\t\t}\n\t});\n});\n"],[1,"    \t\t}\n    \t});\n    });\n    "],[0,"app."]],"start1":5629,"start2":5629,"length1":21,"length2":37},{"diffs":[[0,"ponse){\n    "],[1," "],[1,"   "],[0,"response.con"]],"start1":5703,"start2":5703,"length1":24,"length2":28},{"diffs":[[0,"tion/json\";\n"],[1,"    "],[0,"    db.colle"]],"start1":5750,"start2":5750,"length1":24,"length2":28},{"diffs":[[0,"on){\n       "],[1,"  "],[1,"  "],[0,"if (!err)\n  "]],"start1":5816,"start2":5816,"length1":24,"length2":28},{"diffs":[[0,"f (!err)\n       "],[-1,"{\n"],[1,"    {\n    "],[0,"           colle"]],"start1":5833,"start2":5833,"length1":34,"length2":42},{"diffs":[[0,"\n               "],[1,"    "],[0,"if (!err)\n      "]],"start1":5919,"start2":5919,"length1":32,"length2":36},{"diffs":[[0,"      if (!err)\n"],[1,"    "],[0,"               {"]],"start1":5933,"start2":5933,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"response.write(J"]],"start1":5973,"start2":5973,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"response.end();\n"]],"start1":6037,"start2":6037,"length1":32,"length2":36},{"diffs":[[0,"\n               "],[1,"  "],[1,"  "],[0,"}else\n          "]],"start1":6072,"start2":6072,"length1":32,"length2":36},{"diffs":[[0,"\n               "],[-1,"{\n"],[1,"    {\n   "],[0,"                "]],"start1":6097,"start2":6097,"length1":34,"length2":41},{"diffs":[[0,"                "],[1," "],[0,"writeError(respo"]],"start1":6125,"start2":6125,"length1":32,"length2":33},{"diffs":[[0,"\n               "],[-1,"}\n"],[1,"    }\n    "],[0,"           });\n "]],"start1":6168,"start2":6168,"length1":34,"length2":42},{"diffs":[[0," });\n       "],[1," "],[1,"   "],[0,"}else\n      "]],"start1":6204,"start2":6204,"length1":24,"length2":28},{"diffs":[[0,"else\n       "],[-1,"{\n"],[1,"    {\n  "],[0,"           w"]],"start1":6221,"start2":6221,"length1":26,"length2":32},{"diffs":[[0," {\n             "],[1,"  "],[0,"writeError(respo"]],"start1":6236,"start2":6236,"length1":32,"length2":34},{"diffs":[[0,"    "],[1,"    "],[0,"}\n    "],[1," "],[1,"   "],[0,"});\n"],[-1,"});\n\n"],[1,"    });\n    \n    "],[0,"var "]],"start1":6284,"start2":6284,"length1":23,"length2":43},{"diffs":[[0,"ERROR\";\n"],[1,"    "],[0,"db.open("]],"start1":6343,"start2":6343,"length1":16,"length2":20},{"diffs":[[0,"r){\n    "],[1,"  "],[1,"  "],[0,"if(err) "]],"start1":6374,"start2":6374,"length1":16,"length2":20},{"diffs":[[0,"r) \n    "],[-1,"{\n"],[1,"    {\n   "],[0,"        "],[1," "],[0,"console."]],"start1":6391,"start2":6391,"length1":26,"length2":34},{"diffs":[[0,"e.log(err);\n"],[1,"    "],[0,"        auth"]],"start1":6423,"start2":6423,"length1":24,"length2":28},{"diffs":[[0,"    "],[-1,"}\n\n"],[1,"    }\n    \n    "],[0,"    "]],"start1":6471,"start2":6471,"length1":11,"length2":23},{"diffs":[[0," pass) \n    "],[1,"  "],[-1,"{\n"],[1,"  {\n    "],[0,"        db.a"]],"start1":6504,"start2":6504,"length1":26,"length2":34},{"diffs":[[0,"            "],[1,"    "],[0,"if (err)\n   "]],"start1":6578,"start2":6578,"length1":24,"length2":28},{"diffs":[[0,"rr)\n            "],[-1,"{\n"],[1,"    {\n    "],[0,"                "]],"start1":6599,"start2":6599,"length1":34,"length2":42},{"diffs":[[0,"rr;\n            "],[-1,"}\n"],[1,"    }\n    "],[0,"            app."]],"start1":6661,"start2":6661,"length1":34,"length2":42},{"diffs":[[0,"    "],[1,"    "],[0,"});\n    "],[1,"  "],[-1,"}\n"],[1,"  }\n   "],[0,"    "],[1," "],[0,"else {\n"],[1,"    "],[0,"    "]],"start1":6721,"start2":6721,"length1":29,"length2":45},{"diffs":[[0,"0);\n"],[1,"    "],[0,"    }\n"],[-1,"});\n"],[1,"    });\n})();"]],"start1":6784,"start2":6784,"length1":14,"length2":27}]],"length":6811,"saved":false}
{"ts":1356371481531,"patch":[[{"diffs":[[0,"t(\"/auth"],[1,"orized"],[0,"/\", func"]],"start1":3382,"start2":3382,"length1":16,"length2":22},{"diffs":[[0,"    var "],[-1,"responseObj"],[1,"authObj = isAuthorized(request)"],[0,";\n      "]],"start1":3433,"start2":3433,"length1":27,"length2":47},{"diffs":[[0,"    "],[-1,"\n        if (request.session.user_id)\n        {\n        }"],[1,"response.send(JSON.stringify(authObj));"],[0,"\n   "]],"start1":3529,"start2":3529,"length1":65,"length2":47}]],"length":6819,"saved":false}
{"ts":1356371646555,"patch":[[{"diffs":[[0,"ble\n * \n"],[1," * Finished:\n *      Authentication:\n *          get --> /authorized/ : returns { authorized: true/false, key: userKey }\n *          post --> /login/?username&password : returns { authorized: true/false, error: message }\n * \n"],[0," * Notes"]],"start1":565,"start2":565,"length1":16,"length2":241}]],"length":7044,"saved":false}
{"ts":1356371752221,"patch":[[{"diffs":[[0,"  });\n     \n    "],[-1," "],[0,"function writeEr"]],"start1":2666,"start2":2666,"length1":33,"length2":32},{"diffs":[[0," error)\n    "],[-1," "],[0,"{\n"],[-1," "],[0,"        resp"]],"start1":2711,"start2":2711,"length1":28,"length2":26},{"diffs":[[0,"       response."],[-1,"write"],[1,"send"],[0,"(JSON.stringify("]],"start1":2726,"start2":2726,"length1":37,"length2":36},{"diffs":[[0,"    "],[1,"}\n"],[0,"     "],[-1,"response.end();\n     }\n     \n     /**\n      * Simple test to see if dotcloud push is working from my location\n      */\n    app.get(\"/session/\", function(request, response){\n        if (connect){\n            response.write(\"connect installed\");\n        }\n        if (request.session)\n        {\n            response.write(\"I have a session\");\n            if (request.session.user_id)\n            {\n                response.write(\"I have a user_id: \" + request.session.user_id);\n            }else{\n                request.session.user_id = \"roto\";\n            }\n        }else{\n            response.write(\"request.session does not exist\");\n            if (response.session)\n            {\n                response.write(\"response.session exists\");\n            }\n        }\n        response.end();\n    });"],[0,"\n   "]],"start1":2780,"start2":2780,"length1":811,"length2":15}]],"length":6244,"saved":false}
{"ts":1356371782801,"patch":[[{"diffs":[[0,"   \n    "],[-1," "],[0,"function"]],"start1":2199,"start2":2199,"length1":17,"length2":16},{"diffs":[[0,"equest)\n"],[-1," "],[0,"    {\n  "]],"start1":2230,"start2":2230,"length1":17,"length2":16},{"diffs":[[0,"  {\n        "],[-1," "],[0,"if (request."]],"start1":2240,"start2":2240,"length1":25,"length2":24},{"diffs":[[0,"ser_id)\n"],[-1," "],[0,"        "]],"start1":2273,"start2":2273,"length1":17,"length2":16},{"diffs":[[0,"  {\n            "],[-1," "],[0,"return { authori"]],"start1":2287,"start2":2287,"length1":33,"length2":32},{"diffs":[[0,"r_id };\n        "],[-1," "],[0,"}\n"],[-1," "],[0,"        return {"]],"start1":2354,"start2":2354,"length1":36,"length2":34},{"diffs":[[0,"key: \"\" };\n "],[1,"   }\n    \n    function writeError(response, error)\n    {\n        response.send(JSON.stringify({error: error}));\n"],[0,"    }\n     \n"]],"start1":2408,"start2":2408,"length1":24,"length2":136},{"diffs":[[0,"   \n"],[1,""],[0,"    "],[-1,"function writeError(response, error)\n    {\n        response.send(JSON.stringify({error: error}));\n    }"],[0,"\n   "]],"start1":2779,"start2":2779,"length1":115,"length2":12}]],"length":6246,"saved":false}
{"ts":1356371874846,"patch":[[{"diffs":[[0,"/**\n    "],[-1," "],[0,"* API re"]],"start1":4529,"start2":4529,"length1":17,"length2":16},{"diffs":[[0,"atabase\n"],[-1," "],[0,"    **/\n"]],"start1":4576,"start2":4576,"length1":17,"length2":16},{"diffs":[[0,"e){\n    "],[1,"   "],[-1,"\t"],[1," "],[0,"response"]],"start1":4640,"start2":4640,"length1":17,"length2":20},{"diffs":[[0,"n\";\n    "],[-1,"\t"],[1,"    "],[0,"db.colle"]],"start1":4691,"start2":4691,"length1":17,"length2":20},{"diffs":[[0,"n){\n    "],[-1,"\t\t"],[1,"        "],[0,"if (!err"]],"start1":4749,"start2":4749,"length1":18,"length2":24},{"diffs":[[0,"rr)\n    "],[-1,"\t\t{\n    \t\t\t"],[1,"        {\n                "],[0,"collecti"]],"start1":4771,"start2":4771,"length1":27,"length2":42},{"diffs":[[0,"    "],[-1,"\t\t\t\tif (!err)\n    \t\t\t\t{\n    \t\t\t\t\t"],[1,"                if (!err)\n                    {\n                        "],[0,"resp"]],"start1":4855,"start2":4855,"length1":41,"length2":80},{"diffs":[[0,"       response."],[-1,"write"],[1,"send"],[0,"(JSON.stringify("]],"start1":4924,"start2":4924,"length1":37,"length2":36},{"diffs":[[0,"    "],[-1,"\t\t\t\t\tresponse.end();\n    \t\t\t\t}else\n    \t\t\t\t{\n    \t\t\t\t\twriteError(response, err);\n    \t\t\t\t}\n    \t\t\t});\n    \t\t}else\n    \t\t{\n    \t\t\t"],[1,"                }else\n                    {\n                        writeError(response, err);\n                    }\n                });\n            }else\n            {\n                "],[0,"writ"]],"start1":4971,"start2":4971,"length1":137,"length2":193},{"diffs":[[0,"    "],[-1,"\t\t"],[1,"        "],[0,"}\n    "],[-1,"\t"],[1,"    "],[0,"});\n"]],"start1":5187,"start2":5187,"length1":17,"length2":26}]],"length":6374,"saved":false}
{"ts":1356371911929,"patch":[[{"diffs":[[0,"\n     * "],[-1,"\t"],[1," "],[0,"List of "]],"start1":1940,"start2":1940,"length1":17,"length2":17}]],"length":6374,"saved":false}
